<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { initializeDB, saveNoteToStorage, getNotesFromStorage, getNoteFromStorage } from "./noteStorage.js";

window.addEventListener('DOMContentLoaded', init);

/**
 * @description call all the functions after the DOM is loaded
 */
async function init() {
    const db = await initializeDB(indexedDB);
    const notes = await getNotesFromStorage(db);
    addNotesToDocument(notes);
    await initEventHandler();
}

/**
 * @description append the new row to the dashboard in the document
 * @param {Array&lt;Object>} notes containing all the notes in the local storage
 */
function addNotesToDocument(notes) {
    const dashboard = document.querySelector('.dashboard');

    // Clear out the existing rows in the dashboard
    const dashboardRow = document.querySelectorAll('dashboard-row');
    dashboardRow.forEach(row => {
      row.remove();
    })

    // Repopulate dashboard with new notes
    notes.forEach(note => {
        let row = document.createElement('dashboard-row');  
        row.note = note;
        dashboard.appendChild(row);
        row.shadowRoot.querySelector('.title').addEventListener('click', async event => {
            window.location.href = `./notes/notes.html`;
        }); 
    });
}

/**
 * @description sort the notes by last modified date
 * @param {Array&lt;Object>} notes containing all the notes in the local storage
 * @param {String} sortType the type of sort, either ascending or descending
 * @returns sortedNotes
 */
function sortNotesByTime(notes, sortType) {
  let sortedNotes = notes.sort((note1, note2) => {
    const dateList1 = note1.lastModified.split('/');
    const dateList2 = note2.lastModified.split('/');
    const date1 = new Date(dateList1[2], dateList1[0], dateList1[1]);
    const date2 = new Date(dateList2[2], dateList2[0], dateList2[1]);
    if(sortType === 'asc') {
      return date1 - date2;
    }
    return date2 - date1;
  })

  return sortedNotes;
}

/**
 * @description sort the notes by title
 * @param {Array&lt;Object>} notes containing all the notes in the local storage
 * @param {String} sortType the type of sort, either ascending or descending
 * @returns sortedNotes
 */
 function sortNotesByTitle(notes, sortType) {
  const sortedNotes = notes.sort((note1, note2) => {
    if(sortType === 'asc') {
      return note1.title.localeCompare(note2.title);
    }
    return note2.title.localeCompare(note1.title);
  })
  return sortedNotes;
}

/**
 * @description Add necessary event handler for the Create New Note button
 * @param {Array&lt;Object>} notes containing all the notes in the local storage
 */
async function initEventHandler(){
  const button = document.querySelector('button')
  const dashboard = document.querySelector('.dashboard');
  const db = await initializeDB(indexedDB);
  const notes = await getNotesFromStorage(db);
  //navigate to note page in order for the user to write note
  button.addEventListener('click', async event => {
     let noteObject = {
      "title": "Midterm Prep",
      "lastModified": "11/17/2022",
      "content": ""
    };

    // Add notes to storage
    
    saveNoteToStorage(db, noteObject);
    addNotesToDocument(await getNotesFromStorage(db)); 

    window.location.href = `./notes/notes.html`;
  })

  // sort the notes to display in dashboard by last modified date
  const timeCol = document.querySelector('.timeCol');
  let timeSortCount = 0;
  timeCol.addEventListener('click', async event => {
    let sortedNotes = sortNotesByTime(notes, timeSortCount % 2 === 0 ? 'asc' : 'desc');
    timeSortCount++;
    addNotesToDocument(sortedNotes);
  });

  // sort the notes to display in dashboard by title
  const titleCol = document.querySelector('.titleCol');
  let titleSortCount = 0;
  titleCol.addEventListener('click', async event => {
    const sortedNotes = sortNotesByTitle(notes, titleSortCount % 2 === 0 ? 'asc' : 'desc');
    titleSortCount++;
    addNotesToDocument(sortedNotes);
  })



}




</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="dashboardRow.html">dashboardRow</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addNotesToDocument">addNotesToDocument</a></li><li><a href="global.html#deleteNoteFromStorage">deleteNoteFromStorage</a></li><li><a href="global.html#getNoteFromStorage">getNoteFromStorage</a></li><li><a href="global.html#getNotesFromStorage">getNotesFromStorage</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initEventHandler">initEventHandler</a></li><li><a href="global.html#initializeDB">initializeDB</a></li><li><a href="global.html#saveNoteToStorage">saveNoteToStorage</a></li><li><a href="global.html#sortNotesByTime">sortNotesByTime</a></li><li><a href="global.html#sortNotesByTitle">sortNotesByTitle</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Wed Nov 23 2022 22:21:25 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
